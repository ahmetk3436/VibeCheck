{
  "tasks": [
    {
      "id": "enhance_001",
      "title": "Replace keyword mood analysis with real AI API",
      "description": "The backend vibe_service.go analyzeMood() at line 59 uses simple keyword matching with a hardcoded map and falls back to RANDOM aesthetic selection when no keywords match (line 84-88). The calculateVibeScore() at line 92 is also a naive word counter starting at 50 and adding/subtracting 10 per keyword. This must be replaced with real OpenAI GPT-4o-mini calls.\n\nModify backend/internal/services/vibe_service.go:\n- Add new field to VibeService struct: `openaiKey string` loaded from config\n- Add new config field in backend/internal/config/config.go: `OpenAIKey string` from env var `OPENAI_API_KEY`\n- Pass config.OpenAIKey to NewVibeService() in cmd/server/main.go\n- Replace analyzeMood() with a function that calls https://api.openai.com/v1/chat/completions using net/http and encoding/json\n- System prompt: 'You are a mood-to-aesthetic analyzer. Given a user mood text, respond with JSON: {\"aesthetic_key\": one of [chill,energetic,romantic,melancholy,adventurous,creative,peaceful,confident,cozy,mysterious], \"vibe_score\": 10-100, \"insight\": short 1-sentence insight about their vibe}. Match the aesthetic that best fits the emotional tone.'\n- User prompt: the moodText\n- Parse the JSON response, look up aesthetic from models.Aesthetics map\n- Add fallback: if OPENAI_API_KEY is empty or API call fails, fall back to the existing keyword logic (keep it as fallbackAnalyzeMood)\n- Replace calculateVibeScore() to use the AI-returned vibe_score instead\n- Add new field 'Insight' to models.VibeCheck struct (string, json:\"insight\"), run AutoMigrate\n- Add 'Insight' field to dto/vibe_dto.go VibeCheckResponse\n- Update CreateVibeCheck to store the insight in the database\n- Add env var OPENAI_API_KEY to .env.example",
      "status": "completed",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-06T22:38:19Z"
    },
    {
      "id": "enhance_002",
      "title": "Add onboarding flow with 3 screens and guest mode",
      "description": "The app has NO onboarding (Apple Guideline 2.1 risk). The index.tsx at line 17-21 only checks auth state. Must add 3-screen onboarding + guest mode with 3 free uses.\n\nCreate mobile/app/(onboarding)/_layout.tsx:\n- Import Slot from expo-router\n- Export default function with \u003cSlot /\u003e wrapped in SafeAreaView className='flex-1 bg-white'\n\nCreate mobile/app/(onboarding)/welcome.tsx:\n- Full-screen with large emoji 'âœ¨' (text-8xl), app name 'VibeCheck' (text-4xl font-bold text-gray-900), tagline 'Discover your daily aesthetic' (text-lg text-gray-500 mt-2)\n- Bottom button 'Get Started' using Button component, onPress navigates to features screen\n- Background: bg-white with a View at top having style={{backgroundColor: '#2563eb'}} with 30% opacity as decorative gradient accent\n\nCreate mobile/app/(onboarding)/features.tsx:\n- 3 feature cards in a vertical list: 'ðŸŽ¨ Mood-to-Aesthetic' / 'ðŸ”¥ Daily Streaks' / 'ðŸ“Š Vibe Score Tracking'\n- Each card: rounded-2xl bg-gray-50 p-5 mb-4 with emoji (text-4xl), title (text-lg font-bold), description (text-sm text-gray-500)\n- 'Continue' button at bottom\n\nCreate mobile/app/(onboarding)/start.tsx:\n- Two buttons: 'Try Free' (primary, sets guest mode via AsyncStorage key 'vibecheck_guest_uses' to '3', navigates to protected/home) and 'Sign In' (outline variant, navigates to (auth)/login)\n- Text below: 'Get 3 free vibe checks without an account'\n\nModify mobile/app/index.tsx:\n- Import AsyncStorage from expo-secure-store (use getItemAsync/setItemAsync since it is in package.json)\n- Check 'vibecheck_onboarding_complete' key. If not set, redirect to /(onboarding)/welcome\n- Check 'vibecheck_guest_uses' key. If set and parseInt \u003e 0, redirect to /(protected)/home\n- Then check isAuthenticated as before\n\nModify mobile/contexts/AuthContext.tsx:\n- Add isGuest boolean to context type and state\n- Add checkGuestMode() that reads 'vibecheck_guest_uses' from SecureStore, sets isGuest=true if remaining \u003e 0\n- Add decrementGuestUse() that decrements the counter\n- Call checkGuestMode() in the restore useEffect\n- Modify isAuthenticated to also check isGuest for protected route access\n\nModify mobile/app/(protected)/_layout.tsx:\n- Allow access when isGuest is true (not just isAuthenticated)",
      "status": "pending",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_003",
      "title": "Implement real restore purchases with RevenueCat",
      "description": "Settings.tsx line 61-67 handleRestorePurchases is a STUB that only shows Alert.alert. Apple Guideline 3.1 REQUIRES working restore. The paywall.tsx line 109 also needs proper restore.\n\nModify mobile/app/(protected)/settings.tsx:\n- Import { restorePurchases } from '../../lib/purchases'\n- Import { useSubscription } from '../../contexts/SubscriptionContext'\n- Replace handleRestorePurchases function body:\n  - Call hapticMedium()\n  - Set a local loading state setIsRestoring(true)\n  - try: const result = await restorePurchases()\n  - If result has active entitlement for 'premium', call subscription context refreshStatus()\n  - Alert.alert('Success', 'Your purchases have been restored!')\n  - hapticSuccess()\n  - catch: Alert.alert('No Purchases Found', 'We could not find any previous purchases for this account.')\n  - hapticError()\n  - finally: setIsRestoring(false)\n- Add isRestoring state variable, pass to Button as isLoading prop\n\nModify mobile/app/(protected)/paywall.tsx:\n- Import { restorePurchases } from '../../lib/purchases'\n- Replace the restore button's onPress with same real restore logic\n- Add hapticMedium() on restore press\n- Add hapticSuccess() on successful purchase\n\nModify mobile/contexts/SubscriptionContext.tsx:\n- Add refreshStatus() method that re-calls checkSubscription()\n- Export refreshStatus in context value\n- Add error handling for initializePurchases() failure: wrap in try-catch, if error log and set initialized=false state\n\nModify mobile/lib/purchases.ts:\n- Verify restorePurchases() function exists and returns CustomerInfo\n- Add proper error handling with typed errors\n- Ensure checkSubscriptionStatus() correctly checks for 'premium' entitlement",
      "status": "pending",
      "priority": 9,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_004",
      "title": "Add AI insight display and error feedback to home screen",
      "description": "Home screen (home.tsx) has multiple issues: 1) No error feedback when vibe check fails (line 43-44 only console.logs), 2) No display for the new AI insight field, 3) Share button has no haptic feedback, 4) No loading state when initially fetching today's vibe.\n\nModify mobile/types/vibe.ts:\n- Add 'insight' field (string) to VibeCheck interface\n\nModify mobile/app/(protected)/home.tsx:\n- Add import { Alert } from 'react-native'\n- Add import { hapticError, hapticMedium } from haptics (hapticMedium for share)\n- Add isInitialLoading state (true by default), set to false after loadData completes\n- In loadData catch block: add Alert.alert('Connection Error', 'Could not load your vibe data. Pull down to refresh.')\n- In handleVibeCheck catch block: replace console.log with Alert.alert('Oops!', error.response?.data?.message || 'Could not check your vibe right now. Try again.')\n- Add hapticError() in the catch block\n- Add hapticMedium() at the start of handleShare\n- In the todayVibe card (line 69-85), add insight display after the mood text quote:\n  - \u003cText className='mt-3 text-sm text-white/70'\u003e{todayVibe.insight}\u003c/Text\u003e\n- Add initial loading state: if isInitialLoading, show \u003cView className='flex-1 items-center justify-center'\u003e\u003cActivityIndicator size='large' color='#2563eb' /\u003e\u003cText className='mt-4 text-gray-500'\u003eLoading your vibe...\u003c/Text\u003e\u003c/View\u003e\n- Add ScrollView refreshControl prop with RefreshControl component: refreshing={isRefreshing}, onRefresh={loadData}\n- Add isRefreshing state for pull-to-refresh\n- Import { RefreshControl, ActivityIndicator } from react-native\n\nModify mobile/app/(protected)/history.tsx:\n- Add loading spinner: when isLoading is true, render \u003cView className='flex-1 items-center justify-center py-20'\u003e\u003cActivityIndicator size='large' color='#2563eb' /\u003e\u003cText className='mt-4 text-gray-500'\u003eLoading history...\u003c/Text\u003e\u003c/View\u003e before the FlatList\n- Import ActivityIndicator from react-native",
      "status": "pending",
      "priority": 7,
      "depends_on": [
        "enhance_001"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_005",
      "title": "Replace Tabs navigator with custom Slot-based tab bar",
      "description": "The protected layout at _layout.tsx uses expo-router Tabs component (line 24-74). For NativeWind v4 full styling control, replace with Slot + custom Pressable tab bar.\n\nModify mobile/app/(protected)/_layout.tsx completely:\n- Remove Tabs import, add Slot import from expo-router\n- Import { usePathname, router } from expo-router\n- Import { Pressable, View, Text } from react-native\n- Import { Ionicons } from '@expo/vector-icons'\n- Import { useSafeAreaInsets } from 'react-native-safe-area-context'\n- Import { hapticSelection } from '../../lib/haptics'\n- Import { useAuth } from '../../contexts/AuthContext'\n- Keep auth guard logic (isLoading spinner + !isAuthenticated Redirect)\n- Define tabs array: [{name: 'home', title: 'Vibe', icon: 'sparkles', activeIcon: 'sparkles'}, {name: 'history', title: 'History', icon: 'time-outline', activeIcon: 'time'}, {name: 'settings', title: 'Settings', icon: 'settings-outline', activeIcon: 'settings'}]\n- Return \u003cView className='flex-1 bg-gray-50'\u003e\u003cView className='flex-1'\u003e\u003cSlot /\u003e\u003c/View\u003e{CustomTabBar}\u003c/View\u003e\n- CustomTabBar: \u003cView style={{paddingBottom: insets.bottom}} className='flex-row bg-white border-t border-gray-100 pt-2 pb-2'\u003e\n  - Map tabs: \u003cPressable key={tab.name} onPress={() =\u003e {hapticSelection(); router.push(`/(protected)/${tab.name}`)}} className='flex-1 items-center py-2'\u003e\n    - \u003cIonicons name={isActive ? tab.activeIcon : tab.icon} size={24} color={isActive ? '#8b5cf6' : '#9ca3af'} /\u003e\n    - \u003cText className={`text-xs mt-1 ${isActive ? 'text-violet-500 font-semibold' : 'text-gray-400'}`}\u003e{tab.title}\u003c/Text\u003e\n  - isActive = pathname includes tab.name\n- Paywall screen accessible via router.push only, not in tab bar\n\nNote: Keep using 'sparkles' instead of 'sparkles-outline' for active since Ionicons supports both. Verify icon names exist in Ionicons: sparkles-outline, sparkles, time-outline, time, settings-outline, settings.",
      "status": "pending",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_006",
      "title": "Add shareable vibe result card with gradient background",
      "description": "Home screen share (line 50-59) only shares plain text via Share.share(). Must create a visually appealing card component and share as formatted text with app branding.\n\nCreate mobile/components/ui/VibeCard.tsx:\n- Props: { vibe: VibeCheck, onShare?: () =\u003e void }\n- Import View, Text, Pressable from react-native\n- Import { Ionicons } from '@expo/vector-icons'\n- Root View with className='rounded-3xl overflow-hidden shadow-xl'\n- Top section with style={{backgroundColor: vibe.color_primary}} className='p-8 items-center':\n  - Decorative circles: absolute positioned Views with opacity 0.1, rounded-full, various sizes (w-32 h-32, w-20 h-20) at different positions for depth\n  - Emoji: text-7xl\n  - Aesthetic name: text-2xl font-bold text-white mt-4\n  - Vibe score: text-5xl font-extrabold text-white mt-2 with '/100' in text-lg text-white/60\n  - Insight text if available: text-sm text-white/80 mt-3 text-center italic\n  - Mood text quote: text-base text-white/70 mt-4 text-center with quotation marks\n- Bottom section: View className='bg-white/95 px-6 py-4 flex-row items-center justify-between'\n  - Left: View with app logo area - Text 'VibeCheck' text-sm font-bold text-gray-800 + Text date text-xs text-gray-400\n  - Right: if onShare, Pressable with Ionicons share-outline icon size 20 color gray-600\n\nModify mobile/app/(protected)/home.tsx:\n- Import VibeCard from components\n- Replace the inline todayVibe card (lines 69-85) with \u003cVibeCard vibe={todayVibe} onShare={handleShare} /\u003e\n- Keep the existing Share.share() logic but enhance the message:\n  - message: `${todayVibe.emoji} My vibe today: ${todayVibe.aesthetic}\\n\\nâš¡ Vibe Score: ${todayVibe.vibe_score}/100\\n${todayVibe.insight ? '\\nðŸ’­ ' + todayVibe.insight + '\\n' : ''}\\n\"${todayVibe.mood_text}\"\\n\\nCheck your vibe â†’ vibecheck://`\n- Add hapticMedium() in handleShare",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_007",
      "title": "Add streak milestones and gamification badges",
      "description": "Home screen shows basic streak number (line 123-128) but has no milestone rewards or celebrations. Add streak milestone system.\n\nCreate mobile/components/ui/StreakBadge.tsx:\n- Props: { currentStreak: number, longestStreak: number }\n- Define milestones array: [{days: 3, emoji: 'ðŸŒŸ', title: 'Rising Star', color: '#f59e0b'}, {days: 7, emoji: 'ðŸ’Ž', title: 'Diamond Week', color: '#3b82f6'}, {days: 14, emoji: 'ðŸ”¥', title: 'On Fire', color: '#ef4444'}, {days: 21, emoji: 'ðŸ‘‘', title: 'Vibe Royalty', color: '#8b5cf6'}, {days: 30, emoji: 'ðŸŒˆ', title: 'Legendary', color: '#06b6d4'}]\n- Render a horizontal ScrollView showing earned badges (where currentStreak \u003e= days)\n- Each badge: View className='items-center mr-4 w-16' with:\n  - Outer circle View with style={{backgroundColor: milestone.color}} className='w-14 h-14 rounded-full items-center justify-center shadow-md'\n  - Emoji text-2xl inside\n  - Title text-xs font-medium text-gray-600 mt-1 text-center\n  - Days text-xs text-gray-400\n- Unearned badges: same layout but opacity-30 and bg-gray-200\n- If currentStreak \u003e= next milestone threshold, show progress text: '{daysUntilNext} days to {nextMilestone.title}'\n\nModify mobile/app/(protected)/home.tsx:\n- Import StreakBadge\n- Below the stats row (after line 139), add section:\n  - \u003cView className='mt-6'\u003e\n    - \u003cText className='text-lg font-semibold text-gray-900 mb-3'\u003eStreak Milestones\u003c/Text\u003e\n    - \u003cStreakBadge currentStreak={stats.current_streak} longestStreak={stats.longest_streak} /\u003e\n  - \u003c/View\u003e\n- Only render if stats is not null",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_008",
      "title": "Add haptic feedback to all missing interactive elements",
      "description": "Multiple interactive elements are missing haptic feedback per Apple Guideline 4.2.\n\nModify mobile/app/(protected)/settings.tsx:\n- Import hapticSelection from '../../lib/haptics'\n- Add hapticSelection() call in handleLogout function (currently no haptic at line 107 area before Alert.alert)\n- The Sign Out Pressable should call hapticSelection() onPress before showing the confirmation Alert\n\nModify mobile/app/(protected)/paywall.tsx:\n- Import { hapticSelection, hapticSuccess, hapticError } from '../../lib/haptics'\n- Add hapticSelection() in each package Pressable's onPress handler (line 84-87 area, before setSelectedPackage)\n- Add hapticSuccess() after successful purchase in handlePurchase\n- Add hapticError() in purchase error catch block\n- Add hapticSelection() on restore purchases button press\n\nModify mobile/app/(auth)/login.tsx:\n- Import { hapticSelection } from '../../lib/haptics'\n- Add hapticSelection() when user taps 'Don't have an account? Register' link\n\nModify mobile/app/(auth)/register.tsx:\n- Import { hapticSelection } from '../../lib/haptics'\n- Add hapticSelection() when user taps 'Already have an account? Sign in' link\n\nModify mobile/app/(protected)/history.tsx:\n- Import { hapticSelection } from '../../lib/haptics'\n- If history items become tappable in future, add haptic there\n- Add hapticSelection() to pull-to-refresh trigger (wrap onRefresh callback)\n\nThis task ensures EVERY Pressable/TouchableOpacity/Button interaction in the app triggers appropriate haptic feedback matching the action type: hapticSelection for navigation/selection, hapticSuccess for completions, hapticError for failures, hapticWarning for destructive actions.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_009",
      "title": "Enhance history screen with vibe details and visual cards",
      "description": "History screen (history.tsx) shows a basic FlatList with minimal styling. Need visual vibe cards matching the app's aesthetic quality.\n\nModify mobile/app/(protected)/history.tsx:\n- Import { Ionicons } from '@expo/vector-icons'\n- Import { hapticSelection } from '../../lib/haptics'\n- Replace the FlatList renderItem with enhanced vibe history cards:\n  - Root: View className='mb-4 rounded-2xl overflow-hidden shadow-sm'\n  - Top band: View style={{backgroundColor: item.color_primary}} className='px-5 py-4 flex-row items-center justify-between'\n    - Left: View flex-row items-center gap-3\n      - Text emoji text-3xl\n      - View: Text aesthetic name text-base font-bold text-white, Text date text-xs text-white/60\n    - Right: View items-end\n      - Text vibe_score text-2xl font-bold text-white\n      - Text '/100' text-xs text-white/60\n  - Bottom: View className='bg-white px-5 py-3'\n    - Text mood_text text-sm text-gray-600 italic with quotation marks\n    - If item.insight exists: Text insight text-xs text-gray-400 mt-1\n- Add proper date formatting: use new Date(item.check_date).toLocaleDateString('en-US', {month: 'short', day: 'numeric', year: 'numeric'})\n- Add RefreshControl import and pull-to-refresh with hapticSelection() on refresh\n- Import RefreshControl from react-native\n- Add header above list: View className='px-6 pt-8 pb-4'\u003e\n  - Text 'Vibe History' text-3xl font-bold text-gray-900\n  - Text 'Your mood journey' text-base text-gray-500 mt-1\n- Wrap everything in SafeAreaView className='flex-1 bg-gray-50'\n- Import SafeAreaView from react-native-safe-area-context",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_010",
      "title": "Polish settings screen with sections and visual hierarchy",
      "description": "Settings screen (settings.tsx) needs visual polish with proper section grouping, icons, and consistent styling.\n\nModify mobile/app/(protected)/settings.tsx:\n- Import { Ionicons } from '@expo/vector-icons'\n- Import { useAuth } from '../../contexts/AuthContext'\n- Add user info section at top: View className='items-center pt-8 pb-6'\u003e\n  - Avatar circle: View className='w-20 h-20 rounded-full bg-primary-100 items-center justify-center mb-3'\u003e\n    - Ionicons person-outline size 32 color '#2563eb'\n  - Text user email text-base font-medium text-gray-900\n  - Text 'Free Plan' or 'Premium' text-sm text-gray-500 mt-1 (based on subscription context isSubscribed)\n- Group settings into sections with headers:\n  - Section 'Account': View className='mt-6 mx-6'\u003e\n    - Text section header text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2\n    - View className='rounded-2xl bg-white overflow-hidden shadow-sm'\u003e\n    - Each row: Pressable className='flex-row items-center px-4 py-4 border-b border-gray-50'\u003e\n      - Ionicons icon size 22 color appropriate\n      - Text title text-base text-gray-900 flex-1 ml-3\n      - Ionicons chevron-forward size 16 color gray-300\n  - 'Account' section items: Upgrade to Premium (if not subscribed, navigates to paywall), Restore Purchases, Biometric Lock toggle\n  - 'Support' section items: Privacy Policy (Linking.openURL), Rate App, Share App\n  - 'Danger Zone' section: Sign Out (text-orange-500), Delete Account (text-red-500)\n- Add biometric toggle: use existing biometrics.ts checkBiometricAvailability and authenticate functions\n- Store biometric preference in SecureStore key 'vibecheck_biometric_enabled'\n- The Delete Account row should call hapticWarning and show existing password modal\n- Sign Out row calls hapticSelection and shows confirmation Alert as before\n- Each Pressable row needs hapticSelection() onPress\n- Import { useSafeAreaInsets } from react-native-safe-area-context for bottom padding\n- Wrap in ScrollView for scrollable content",
      "status": "pending",
      "priority": 7,
      "depends_on": [
        "enhance_003"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_011",
      "title": "Add content moderation filter to vibe check endpoint",
      "description": "The backend moderation_service.go has only 2 regex patterns (spam, scam) at line 21-26. The vibe check endpoint at vibe_handler.go does NOT call content moderation before creating a vibe. This violates Apple Guideline 1.2 for UGC safety.\n\nModify backend/internal/services/moderation_service.go:\n- Expand ProfanityPatterns with comprehensive word list: add patterns for common profanity, slurs, hate speech, self-harm keywords, violence\n- Add at least 20 regex patterns covering major categories\n- Add new method ValidateMoodText(text string) (bool, string) that:\n  - Checks text length (min 3 chars, max 500)\n  - Runs through ProfanityPatterns\n  - Returns false with specific reason if blocked\n  - Returns true, '' if clean\n\nModify backend/internal/services/vibe_service.go:\n- Add moderationService *ModerationService field to VibeService struct\n- Update NewVibeService to accept ModerationService parameter\n- In CreateVibeCheck, before analyzing mood, call moderationService.ValidateMoodText(moodText)\n- If not clean, return error with the moderation reason\n- Update cmd/server/main.go to pass moderationService to NewVibeService\n\nModify backend/internal/handlers/vibe_handler.go:\n- In CreateVibeCheck handler, check for moderation error specifically\n- Return HTTP 422 Unprocessable Entity with message 'Your message contains content that violates our community guidelines. Please rephrase and try again.'\n- This distinguishes moderation rejections from other errors\n\nModify backend/cmd/server/main.go:\n- Update vibeService initialization to pass moderationService",
      "status": "pending",
      "priority": 9,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_012",
      "title": "Enhance login and register screens with visual polish",
      "description": "Login (login.tsx) and register (register.tsx) screens need visual polish with gradient accents, better spacing, and a guest mode option.\n\nModify mobile/app/(auth)/login.tsx:\n- Add top decorative section: View style={{backgroundColor: '#2563eb'}} className='h-48 items-center justify-end pb-8 rounded-b-3xl'\u003e\n  - Text 'âœ¨' text-5xl\n  - Text 'VibeCheck' text-3xl font-bold text-white mt-2\n- Move form into a View className='px-6 -mt-6' with a View className='bg-white rounded-3xl p-6 shadow-lg'\u003e\n- Style the email input placeholder as 'Email address' (not 'you@example.com')\n- Style the password input placeholder as 'Password'\n- Add 'Forgot password?' text link (text-sm text-primary-600 text-right mt-2) - can be non-functional placeholder link for now\n- Add divider: View className='flex-row items-center my-6'\u003e with two flex-1 h-px bg-gray-200 Views and Text 'or' text-gray-400 mx-4\n- Place AppleSignInButton below divider\n- Add 'Skip for now' Pressable below everything: Text className='text-center text-primary-600 text-sm font-medium mt-6'\n  - onPress: set guest mode in SecureStore ('vibecheck_guest_uses' = '3'), mark onboarding complete, navigate to (protected)/home\n  - Import hapticSelection, call on press\n- Change 'Don't have an account?' link styling: text-sm text-gray-500 with 'Register' in text-primary-600 font-semibold\n\nModify mobile/app/(auth)/register.tsx:\n- Same top decorative section as login but with Text 'Create Account' text-2xl font-bold text-white\n- Same white card form container\n- Change placeholder from 'you@example.com' to 'Email address'\n- Add password requirements hint: Text className='text-xs text-gray-400 mt-1' content 'Must be at least 8 characters'\n- Add hapticSelection to 'Already have an account? Sign in' link\n- Error display: View className='bg-red-50 rounded-xl p-3 mb-4' with Text text-red-600 text-sm",
      "status": "pending",
      "priority": 7,
      "depends_on": [
        "enhance_002"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_013",
      "title": "Add admin role middleware and Apple token verification",
      "description": "Two CRITICAL security issues: 1) Admin endpoints have NO role check (routes.go line 49) - any authenticated user can access admin panel. 2) Apple Sign-In token signature is NOT verified (auth_service.go line 146-201).\n\nModify backend/internal/models/user.go:\n- Add Role field: `Role string json:\"role\" gorm:\"default:'user'\"` with values 'user' or 'admin'\n- This will AutoMigrate and add the column\n\nModify backend/internal/middleware/auth.go:\n- Add new middleware function AdminRequired() fiber.Handler:\n  - Extract userID from c.Locals('userID')\n  - Query database for user, check Role == 'admin'\n  - If not admin, return 403 Forbidden with message 'Admin access required'\n  - Pass db *gorm.DB to middleware via closure: func AdminRequired(db *gorm.DB) fiber.Handler\n\nModify backend/internal/routes/routes.go:\n- Add AdminRequired middleware to admin group: admin := api.Group('/admin', middleware.JWTProtected(cfg), middleware.AdminRequired(db))\n- Pass db parameter to SetupRoutes function signature\n- Update cmd/server/main.go to pass db to SetupRoutes\n\nModify backend/internal/services/auth_service.go:\n- Add Apple token verification in AppleSignIn method:\n  - Fetch Apple's public keys from https://appleid.apple.com/auth/keys using net/http\n  - Parse the JWKS response to get the signing key\n  - Verify the JWT signature using crypto/rsa and crypto/x509\n  - Verify claims: iss == 'https://appleid.apple.com', aud == your app bundle ID (from config)\n  - Verify exp is not expired\n  - Add AppBundleID to config.go from env var APPLE_BUNDLE_ID\n  - If verification fails, return error 'invalid Apple identity token'\n  - Add import for 'crypto/rsa', 'crypto/x509', 'encoding/pem', 'math/big'\n  - Cache Apple's public keys for 24 hours to avoid repeated fetches (use sync.Once or time-based cache)",
      "status": "in_progress",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-06T22:38:19Z"
    },
    {
      "id": "enhance_014",
      "title": "Add paywall gate for guest users and premium features",
      "description": "The app needs a proper free/premium gate. Guest users get 3 free vibe checks, free authenticated users get 3/day, premium gets unlimited. Currently the backend limits to 1/day (vibe_service.go line 28) with no tier differentiation.\n\nModify backend/internal/services/vibe_service.go:\n- Change CreateVibeCheck to accept a isPremium bool parameter\n- For free users: check count of vibes created today, limit to 3 per day. Use query: SELECT COUNT(*) FROM vibe_checks WHERE user_id = ? AND check_date = ? (today)\n  - If count \u003e= 3 and !isPremium, return error 'Daily limit reached. Upgrade to Premium for unlimited vibe checks!'\n- For premium users: allow unlimited checks per day (remove the single-check-per-day restriction)\n- Remove the 'already checked in today' error for premium users\n\nModify backend/internal/handlers/vibe_handler.go:\n- In CreateVibeCheck handler, check user subscription status from database\n- Query Subscription model where user_id = userID AND status = 'active'\n- Pass isPremium boolean to vibeService.CreateVibeCheck\n\nModify backend/internal/dto/vibe_dto.go:\n- Add to VibeStatsResponse: DailyUsed int `json:\"daily_used\"` and DailyLimit int `json:\"daily_limit\"` and IsPremium bool `json:\"is_premium\"`\n\nModify backend/internal/services/vibe_service.go GetVibeStats:\n- Add daily_used count (vibes created today for this user)\n- Add daily_limit (3 for free, -1 for unlimited/premium)\n- Add is_premium flag\n\nModify mobile/app/(protected)/home.tsx:\n- After a failed vibe check with 'Daily limit reached' message, show a 'Go Premium' button that navigates to paywall\n- Display remaining uses: if stats.daily_limit \u003e 0, show '{stats.daily_limit - stats.daily_used} checks left today' text below the input area\n\nModify mobile/types/vibe.ts:\n- Add daily_used, daily_limit, is_premium to VibeStats interface",
      "status": "pending",
      "priority": 8,
      "depends_on": [
        "enhance_001"
      ],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_015",
      "title": "Add privacy policy screen and app metadata links",
      "description": "Apple requires a privacy policy URL (Guideline 5.1) and the app has no privacy policy screen or external link.\n\nCreate mobile/app/(protected)/privacy.tsx:\n- Import ScrollView, Text, View from react-native\n- Import SafeAreaView from react-native-safe-area-context\n- Display a comprehensive privacy policy with sections:\n  - 'Privacy Policy' header: text-3xl font-bold text-gray-900\n  - 'Last updated: February 2026' text-sm text-gray-400\n  - Sections in View className='mt-6' with Text headers text-lg font-bold text-gray-900 mb-2:\n    1. 'Information We Collect': email, mood text entries, usage data\n    2. 'How We Use Your Data': provide the service, improve algorithms, no selling to third parties\n    3. 'AI Processing': 'We use OpenAI to analyze mood text. Your mood entries are sent to OpenAI for processing. We do not store your data on OpenAI servers beyond the API call.'\n    4. 'Data Storage': data stored securely, encrypted at rest\n    5. 'Your Rights': request data export, request deletion (via Settings \u003e Delete Account)\n    6. 'Third-Party Services': RevenueCat for subscriptions, Apple for authentication\n    7. 'Contact': support email placeholder\n  - Each paragraph: Text className='text-base text-gray-600 leading-6 mb-4'\n\nModify mobile/app/(protected)/settings.tsx:\n- Add 'Privacy Policy' row in Support section that navigates to /(protected)/privacy using router.push\n\nModify backend/internal/handlers/health_handler.go:\n- Add a new endpoint GET /api/privacy that returns the privacy policy as JSON with sections array\n- This allows the mobile app to fetch updated policy without app update\n\nModify backend/internal/routes/routes.go:\n- Add public route: api.Get('/privacy', healthHandler.GetPrivacyPolicy)\n\nNote: For App Store submission, the privacy policy URL should point to a hosted web page. The in-app screen is supplementary.",
      "status": "pending",
      "priority": 6,
      "depends_on": [
        "enhance_010"
      ],
      "test_command": "cd backend \u0026\u0026 go build ./... \u0026\u0026 cd ../mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    }
  ]
}